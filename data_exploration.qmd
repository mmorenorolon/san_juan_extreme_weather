---
title: "Exploratory Data Analysis of San Juan NCEI Weather Data"
author: "Melannie Moreno Rolón"
format:
  html:
    toc: true
    toc-depth: 2
    code-fold: true
editor_options: 
  chunk_output_type: console
---

## Project objective
This project investigates whether extreme precipitation events have increased in San Juan, Puerto Rico, over the last 50 years. I use daily precipitation data from the NCEI's Luis Muñoz Marin International Airport station to identify and count extreme rainfall events by year.

#1. Import and inspect data
```{r}
#| include: false
# Import libraries
library(tidyverse)
library(here)
library(ggplot2)
library(lubridate)

# Read in data
raw_data <- read_csv(here::here("raw_data","sju_ncei_data.csv"), na = "NA") %>% janitor::clean_names()

# View dataframe
head(raw_data)
```

#2. Rename columns
```{r}
#Rename column names
names(raw_data) <- c("date", "tavg_degrees_fahrenheit", "tmax_degrees_fahrenheit", "tmin_degrees_fahrenheit", "prcp_inches",  "snow_inches", "snwd_inches")

raw_data
# Remove the first row of  the data frame
raw_data <- raw_data[-c(1), ]

raw_data
```

#3. Check variable data types

```{r}
# Check the class of the dataframe
class(raw_data)

# Check if every column in data frame is numeric
sapply(raw_data, is.numeric)

# Return the datatype of the precipitation column by converting column to numeric with transform()
raw_data <- transform(raw_data, prcp_inches = as.numeric(raw_data$prcp_inches))  
# Check if precipitation column values are numeric
sapply(raw_data$prcp_inches, is.numeric)
```

#4. Datetime formatting

```{r}
# Convert date column to datetime format
raw_data <- raw_data %>% 
  mutate(date = lubridate::mdy(date))

# Check class of date column
class(raw_data$date)
```


# Summary statistics
```{r}
# Summary statistics for precipitation variable
summary(raw_data$prcp_inches)
```

# Scatterplot
```{r}
# See all data points from 1941 to 2025
ggplot(raw_data, aes(x = date, y = prcp_inches)) +
  geom_point(color = "mediumblue", alpha = 0.4) +
  labs(title = "Daily Precipitation in San Juan (1941–2025)",
       x = "Date", 
       y = "Precipitation (inches)") +
  theme_classic()
```

# Histogram

```{r}
hist(raw_data$prcp_inches,  
     main = "Distribution of Precipitation",
     xlab = "Precipitation (inches)",
     col = "navy",
     border = "white")
```

The scatter plot and histogram shows that daily precipitation in San Juan is highly skewed, with most days recording little or no rainfall and a few days experiencing much higher totals. This pattern is typical of tropical rainfall regimes dominated by sporadic heavy rain events. To investigate whether these extreme events have become more frequent over time, further analysis with the negative binomial model will examine long-term trends in heavy precipitation days. 